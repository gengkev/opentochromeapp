/*
 * Compiled on 4/4/2011 using the Closure Compiler, with simple optimization.
 * http://closure-compiler.appspot.com/
 *
 *
 * Port of a script by Masanao Izumo.
 *
 * Only changes : wrap all the variables in a function and add the 
 * main function to JSZip (DEFLATE compression method).
 * Everything else was written by M. Izumo.
 *
 * Original code can be found here: http://www.onicos.com/staff/iz/amuse/javascript/expert/inflate.txt
 *
 *
 * Original:
 *   http://www.onicos.com/staff/iz/amuse/javascript/expert/deflate.txt
 *
 *
 * Copyright (C) 1999 Masanao Izumo <iz@onicos.co.jp>
 * Version: 1.0.1
 * LastModified: Dec 25 1999
 *
 *
 * Interface:
 * data = zip_deflate(src);
 */

if(!JSZip)throw"JSZip not defined";
(function(){var la=parseInt(5),L,m,$,ma,M=null,p,n,aa,f,na,oa,v,J,w,B,x,K,Aa,S,h,s,g,T,C,j,Ba,pa,N,Ca,y,D,E,O,o,t,u,F,q,k,G,Q,z,U,P,qa,ba,ca,H,da,ra,V,ea,R,fa,ga,sa,W=function(){this.dl=this.fc=0},ta=function(){this.extra_bits=this.static_tree=this.dyn_tree=null;this.max_code=this.max_length=this.elems=this.extra_base=0},A=function(a,e,d,b){this.good_length=a;this.max_lazy=e;this.nice_length=d;this.max_chain=b},Qa=function(){this.next=null;this.len=0;this.ptr=Array(8192);this.off=0},ua=[0,0,0,0,0,
0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],X=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Ra=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Da=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],va=[new A(0,0,0,0),new A(4,4,8,4),new A(4,5,16,8),new A(4,6,32,32),new A(4,4,16,16),new A(8,16,32,32),new A(8,16,128,128),new A(8,32,128,256),new A(32,128,258,1024),new A(32,258,258,4096)],ha=function(a){M[n+p++]=a;if(n+p==8192&&p!=0){var e;L!=null?(a=L,L=L.next):a=new Qa;a.next=null;
a.len=a.off=0;m==null?m=$=a:$=$.next=a;a.len=p-n;for(e=0;e<a.len;e++)a.ptr[e]=M[n+e];p=n=0}},ia=function(a){a&=65535;n+p<8190?(M[n+p++]=a&255,M[n+p++]=a>>>8):(ha(a&255),ha(a>>>8))},ja=function(){x=(x<<la^f[g+3-1]&255)&8191;K=v[32768+x];v[g&32767]=K;v[32768+x]=g},I=function(a,e){r(e[a].fc,e[a].dl)},Ea=function(a,e,d){return a[e].fc<a[d].fc||a[e].fc==a[d].fc&&z[e]<=z[d]},Fa=function(a,e,d){var b;for(b=0;b<d&&sa<ga.length;b++)a[e+b]=ga.charCodeAt(sa++)&255;return b},Ha=function(a){var e=Ba,d=g,b,c=s,
i=g>32506?g-32506:0,wa=g+258,Ga=f[d+c-1],Y=f[d+c];s>=Ca&&(e>>=2);do if(b=a,!(f[b+c]!=Y||f[b+c-1]!=Ga||f[b]!=f[d]||f[++b]!=f[d+1])){d+=2;b++;do;while(f[++d]==f[++b]&&f[++d]==f[++b]&&f[++d]==f[++b]&&f[++d]==f[++b]&&f[++d]==f[++b]&&f[++d]==f[++b]&&f[++d]==f[++b]&&f[++d]==f[++b]&&d<wa);b=258-(wa-d);d=wa-258;if(b>c){T=a;c=b;if(b>=258)break;Ga=f[d+c-1];Y=f[d+c]}}while((a=v[a&32767])>i&&--e!=0);return c},xa=function(){var a,e,d=65536-j-g;if(d==-1)d--;else if(g>=65274){for(a=0;a<32768;a++)f[a]=f[a+32768];
T-=32768;g-=32768;B-=32768;for(a=0;a<8192;a++)e=v[32768+a],v[32768+a]=e>=32768?e-32768:0;for(a=0;a<32768;a++)e=v[a],v[a]=e>=32768?e-32768:0;d+=32768}C||(a=Fa(f,g+j,d),a<=0?C=!0:j+=a)},Sa=function(a,e,d){var b;if(!ma){if(!C){w=J=0;var c,i;if(O[0].dl==0){t.dyn_tree=y;t.static_tree=E;t.extra_bits=ua;t.extra_base=257;t.elems=286;t.max_length=15;t.max_code=0;u.dyn_tree=D;u.static_tree=O;u.extra_bits=X;u.extra_base=0;u.elems=30;u.max_length=15;u.max_code=0;F.dyn_tree=o;F.static_tree=null;F.extra_bits=Ra;
F.extra_base=0;F.elems=19;F.max_length=7;for(i=c=F.max_code=0;i<28;i++){qa[i]=c;for(b=0;b<1<<ua[i];b++)U[c++]=i}U[c-1]=i;for(i=c=0;i<16;i++){ba[i]=c;for(b=0;b<1<<X[i];b++)P[c++]=i}for(c>>=7;i<30;i++){ba[i]=c<<7;for(b=0;b<1<<X[i]-7;b++)P[256+c++]=i}for(b=0;b<=15;b++)q[b]=0;for(b=0;b<=143;)E[b++].dl=8,q[8]++;for(;b<=255;)E[b++].dl=9,q[9]++;for(;b<=279;)E[b++].dl=7,q[7]++;for(;b<=287;)E[b++].dl=8,q[8]++;Ia(E,287);for(b=0;b<30;b++)O[b].dl=5,O[b].fc=Ja(b,5);Ka()}for(b=0;b<8192;b++)v[32768+b]=0;pa=va[N].max_lazy;
Ca=va[N].good_length;Ba=va[N].max_chain;B=g=0;j=Fa(f,0,65536);if(j<=0)C=!0,j=0;else{for(C=!1;j<262&&!C;)xa();for(b=x=0;b<2;b++)x=(x<<la^f[b]&255)&8191}m=null;n=p=0;N<=3?(s=2,h=0):(h=2,S=0);aa=!1}ma=!0;if(j==0)return aa=!0,0}if((b=La(a,e,d))==d)return d;if(aa)return b;if(N<=3)for(;j!=0&&m==null;){ja();K!=0&&g-K<=32506&&(h=Ha(K),h>j&&(h=j));if(h>=3)if(i=Z(g-T,h-3),j-=h,h<=pa){h--;do g++,ja();while(--h!=0);g++}else g+=h,h=0,x=f[g]&255,x=(x<<la^f[g+1]&255)&8191;else i=Z(0,f[g]&255),j--,g++;i&&(ka(0),
B=g);for(;j<262&&!C;)xa()}else for(;j!=0&&m==null;){ja();s=h;Aa=T;h=2;K!=0&&s<pa&&g-K<=32506&&(h=Ha(K),h>j&&(h=j),h==3&&g-T>4096&&h--);if(s>=3&&h<=s){i=Z(g-1-Aa,s-3);j-=s-1;s-=2;do g++,ja();while(--s!=0);S=0;h=2;g++;i&&(ka(0),B=g)}else S!=0?Z(0,f[g-1]&255)&&(ka(0),B=g):S=1,g++,j--;for(;j<262&&!C;)xa()}j==0&&(S!=0&&Z(0,f[g-1]&255),ka(1),aa=!0);return b+La(a,b+e,d-b)},La=function(a,e,d){var b,c,i;for(b=0;m!=null&&b<d;){c=d-b;if(c>m.len)c=m.len;for(i=0;i<c;i++)a[e+b+i]=m.ptr[m.off+i];m.off+=c;m.len-=
c;b+=c;if(m.len==0)c=m,m=m.next,c.next=L,L=c}if(b==d)return b;if(n<p){c=d-b;c>p-n&&(c=p-n);for(i=0;i<c;i++)a[e+b+i]=M[n+i];n+=c;b+=c;p==n&&(p=n=0)}return b},Ka=function(){var a;for(a=0;a<286;a++)y[a].fc=0;for(a=0;a<30;a++)D[a].fc=0;for(a=0;a<19;a++)o[a].fc=0;y[256].fc=1;V=H=da=ra=R=fa=0;ea=1},ya=function(a,e){for(var d=k[e],b=e<<1;b<=G;){b<G&&Ea(a,k[b+1],k[b])&&b++;if(Ea(a,d,k[b]))break;k[e]=k[b];e=b;b<<=1}k[e]=d},Ia=function(a,e){var d=Array(16),b=0,c;for(c=1;c<=15;c++)b=b+q[c-1]<<1,d[c]=b;for(b=
0;b<=e;b++)if(c=a[b].dl,c!=0)a[b].fc=Ja(d[c]++,c)},za=function(a){var e=a.dyn_tree,d=a.static_tree,b=a.elems,c,i=-1,f=b;G=0;Q=573;for(c=0;c<b;c++)e[c].fc!=0?(k[++G]=i=c,z[c]=0):e[c].dl=0;for(;G<2;)c=k[++G]=i<2?++i:0,e[c].fc=1,z[c]=0,R--,d!=null&&(fa-=d[c].dl);a.max_code=i;for(c=G>>1;c>=1;c--)ya(e,c);do c=k[1],k[1]=k[G--],ya(e,1),d=k[1],k[--Q]=c,k[--Q]=d,e[f].fc=e[c].fc+e[d].fc,z[f]=z[c]>z[d]+1?z[c]:z[d]+1,e[c].dl=e[d].dl=f,k[1]=f++,ya(e,1);while(G>=2);k[--Q]=k[1];f=a.dyn_tree;c=a.extra_bits;b=a.extra_base;
d=a.max_code;var g=a.max_length,Y=a.static_tree,h,l,j,m,n=0;for(l=0;l<=15;l++)q[l]=0;f[k[Q]].dl=0;for(a=Q+1;a<573;a++)if(h=k[a],l=f[f[h].dl].dl+1,l>g&&(l=g,n++),f[h].dl=l,!(h>d))q[l]++,j=0,h>=b&&(j=c[h-b]),m=f[h].fc,R+=m*(l+j),Y!=null&&(fa+=m*(Y[h].dl+j));if(n!=0){do{for(l=g-1;q[l]==0;)l--;q[l]--;q[l+1]+=2;q[g]--;n-=2}while(n>0);for(l=g;l!=0;l--)for(h=q[l];h!=0;)if(c=k[--a],!(c>d)){if(f[c].dl!=l)R+=(l-f[c].dl)*f[c].fc,f[c].fc=l;h--}}Ia(e,i)},Ma=function(a,e){var d,b=-1,c,i=a[0].dl,f=0,g=7,h=4;i==
0&&(g=138,h=3);a[e+1].dl=65535;for(d=0;d<=e;d++)c=i,i=a[d+1].dl,++f<g&&c==i||(f<h?o[c].fc+=f:c!=0?(c!=b&&o[c].fc++,o[16].fc++):f<=10?o[17].fc++:o[18].fc++,f=0,b=c,i==0?(g=138,h=3):c==i?(g=6,h=3):(g=7,h=4))},Na=function(a,e){var d,b=-1,c,f=a[0].dl,g=0,h=7,j=4;f==0&&(h=138,j=3);for(d=0;d<=e;d++)if(c=f,f=a[d+1].dl,!(++g<h&&c==f)){if(g<j){do I(c,o);while(--g!=0)}else c!=0?(c!=b&&(I(c,o),g--),I(16,o),r(g-3,2)):g<=10?(I(17,o),r(g-3,3)):(I(18,o),r(g-11,7));g=0;b=c;f==0?(h=138,j=3):c==f?(h=6,j=3):(h=7,j=
4)}},ka=function(a){var e,d,b,c;c=g-B;ca[ra]=V;za(t);za(u);Ma(y,t.max_code);Ma(D,u.max_code);za(F);for(b=18;b>=3;b--)if(o[Da[b]].dl!=0)break;R+=3*(b+1)+14;e=R+3+7>>3;d=fa+3+7>>3;d<=e&&(e=d);if(c+4<=e&&B>=0){r(0+a,3);Oa();ia(c);ia(~c);for(b=0;b<c;b++)ha(f[B+b])}else if(d==e)r(2+a,3),Pa(E,O);else{r(4+a,3);c=t.max_code+1;e=u.max_code+1;b+=1;r(c-257,5);r(e-1,5);r(b-4,4);for(d=0;d<b;d++)r(o[Da[d]].dl,3);Na(y,c-1);Na(D,e-1);Pa(y,D)}Ka();a!=0&&Oa()},Z=function(a,e){oa[H++]=e;a==0?y[e].fc++:(a--,y[U[e]+256+
1].fc++,D[(a<256?P[a]:P[256+(a>>7)])&255].fc++,na[da++]=a,V|=ea);ea<<=1;(H&7)==0&&(ca[ra++]=V,V=0,ea=1);if(N>2&&(H&4095)==0){var d=H*8,b=g-B,c;for(c=0;c<30;c++)d+=D[c].fc*(5+X[c]);d>>=3;if(da<parseInt(H/2)&&d<parseInt(b/2))return!0}return H==8191||da==8192},Pa=function(a,e){var d,b=0,c=0,f=0,g=0,h,j;if(H!=0){do(b&7)==0&&(g=ca[f++]),d=oa[b++]&255,(g&1)==0?I(d,a):(h=U[d],I(h+256+1,a),j=ua[h],j!=0&&(d-=qa[h],r(d,j)),d=na[c++],h=(d<256?P[d]:P[256+(d>>7)])&255,I(h,e),j=X[h],j!=0&&(d-=ba[h],r(d,j))),g>>=
1;while(b<H)}I(256,a)},r=function(a,e){w>16-e?(J|=a<<w,ia(J),J=a>>16-w,w+=e-16):(J|=a<<w,w+=e)},Ja=function(a,e){var d=0;do d|=a&1,a>>=1,d<<=1;while(--e>0);return d>>1},Oa=function(){w>8?ia(J):w>0&&ha(J);w=J=0};JSZip.compressions.DEFLATE={magic:"\u0008\0",compress:function(a){var e=void 0;ga=a;sa=0;typeof e=="undefined"&&(e=6);(a=e)?a<1?a=1:a>9&&(a=9):a=6;N=a;C=ma=!1;if(M==null){L=m=$=null;M=Array(8192);f=Array(65536);na=Array(8192);oa=Array(32832);v=Array(65536);y=Array(573);for(a=0;a<573;a++)y[a]=
new W;D=Array(61);for(a=0;a<61;a++)D[a]=new W;E=Array(288);for(a=0;a<288;a++)E[a]=new W;O=Array(30);for(a=0;a<30;a++)O[a]=new W;o=Array(39);for(a=0;a<39;a++)o[a]=new W;t=new ta;u=new ta;F=new ta;q=Array(16);k=Array(573);z=Array(573);U=Array(256);P=Array(512);qa=Array(29);ba=Array(30);ca=Array(parseInt(1024))}for(var d=Array(1024),b=[];(a=Sa(d,0,d.length))>0;){var c=Array(a);for(e=0;e<a;e++)c[e]=String.fromCharCode(d[e]);b[b.length]=c.join("")}ga=null;return b.join("")}}})();